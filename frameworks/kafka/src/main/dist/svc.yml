name: {{FRAMEWORK_NAME}}
principal: {{FRAMEWORK_PRINCIPLE}}
zookeeper: {{MESOS_ZOOKEEPER_URI}}
api-port: {{PORT_API}}
pods:
  kafka-pod:
    count: {{BROKER_COUNT}}
    placement: {{PLACEMENT_CONSTRAINTS}}
    uris:
      - {{KAFKA_URI}}
      - {{BOOTSTRAP_URI}}
    tasks:
      broker:
        cpus: {{BROKER_CPUS}}
        memory: {{BROKER_MEM}}
        ports:
          broker-port:
            port: {{BROKER_PORT}}
        volume:
          path: broker-data
          type: {{BROKER_DISKTYPE}}
          size: {{BROKER_DISKSIZE}}
        goal: RUNNING
        cmd:  "env && ./bootstrap -resolve=false && exec $MESOS_SANDBOX/{{KAFKA_VERSION_PATH}}/bin/kafka-server-start.sh $MESOS_SANDBOX/{{KAFKA_VERSION_PATH}}/config/server.properties"
        server-properties:
          template: "{{CONFIG_TEMPLATE_PATH}}/server.properties.mustache"
          dest: "{{KAFKA_VERSION_PATH}}/config/server.properties"
        env:
          KAFKA_BROKER_PORT: {{PORT_BROKER_PORT}}
plans:
  deploy:
    strategy: serial
    phases:
      Deployment:
        strategy: {{PHASE_STRATEGY}}
        pod: kafka-pod
